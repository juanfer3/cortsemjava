<?php
include "Conexion.php";
include "ConexionPDO.php";
define("MYSQL_CONN_ERROR", "Unable to connect to database."); 
mysqli_report(MYSQLI_REPORT_ERROR | MYSQLI_REPORT_STRICT);
class Usuario{
	
	protected $usuario;
	protected $contrasena;
	protected $rol;
	protected $habilitado;
	

	
	public function __construct($usuario, $contrasena,$rol){
		
		$this->usuario=$usuario;
		$this->contrasena=$contrasena;
		$this->rol=$rol;
		
		
		}
	
	
	public function insert($usuario, $contrasena,$rol){
		$this->habilitado="si";
		$db = new Conexion();
		
		$sql="INSERT INTO usuarios(usuario, contrasena, rol, habilitado)VALUES('$this->usuario', '$this->contrasena','$this->rol','$this->habilitado');";
		try{
		$db->query($sql) ? $r="insertado : )" : $r= "No se Inserto  :(";
                return $id;$id= mysqli_insert_id($this->db);
                $db=NULL;
                return $id;
		echo $r;
		}catch(Exception $e) {
    echo 'ERROR:'.$e->getMessage();
}
	}
	
	static function nigunDato(){
		
		return new self(" "," ", " "," ");
	}
	
	public function ListarUsuarios(){
		
		
		
		try{
			
			$this->habilitado="si";
			$db = new Conexion();
		
			$sql = "select * from usuarios ORDER BY nombre DESC";
			
			$rs= $db->$query($sql);
			
			if($rs->num_rows > 0){
				
				$data[]=array();
				while($row=$rs->fetch_assoc()){
					
					$data[]=$row;
				}
				return $data;
			}else{
				
				echo"No hay registros en la base de datos";
			}
		
			
		return "exito";
		
		}catch(Exception $e){
		
			echo 'ERROR ;('.$e->getMessage();
		}
	}
	
	
}

?>